"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)},__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var a=Array(e),i=0;for(r=0;r<t;r++)for(var n=arguments[r],l=0,c=n.length;l<c;l++,i++)a[i]=n[l];return a};exports.__esModule=!0;var react_1=require("react"),react_router_dom_1=require("react-router-dom"),react_credit_cards_2_1=require("react-credit-cards-2");require("react-credit-cards-2/dist/es/styles-compiled.css"),require("./CreditCard.css");var material_1=require("@mui/material"),formik_1=require("formik"),Yup=require("yup"),Data_1=require("../Data"),CreditCard=function(e){function t(e){y(e.currentTarget)}function a(e){_(e.target.name)}function i(){y(null)}function n(){if(u.number&&u.name&&u.expiry&&u.cvc&&u.country)if(Data_1.blockedCountries.includes(u.country))alert("Card submission is blocked for the selected country.");else{var e=JSON.parse(localStorage.getItem("creditCards")||"[]");e.some(function(e){return e.number===u.number})?alert("This card has already been captured."):(localStorage.setItem("creditCards",JSON.stringify(__spreadArrays(e,[u]))),r(u),p(!1),o("/table"))}else alert("Please fill in all card details.")}function l(e){var r=e.target.value.replace(/\D/g,"");if(16<r.length)alert("Card Number must be 16 digits");else{var t=r.replace(/(\d{4})/g,"$1 ").trim();m(function(e){return __assign(__assign({},e),{number:t})})}}function c(e){var r=e.target.value.replace(/\D/g,"").replace(/(\d{2})(\d{2})/,"$1/$2");m(function(e){return __assign(__assign({},e),{expiry:r})})}var r=e.onCardSubmit,o=react_router_dom_1.useNavigate(),s=react_1.useState({number:"",name:"",expiry:"",cvc:"",country:""}),u=s[0],m=s[1],d=react_1.useState(void 0),_=(d[0],d[1]),f=react_1.useState(!1),g=f[0],p=f[1],v=react_1.useState(null),b=v[0],y=v[1],E=Yup.object().shape({number:Yup.string().required("Card Number is required").matches(/^\d{16}$/,"Card Number must be 16 digits"),name:Yup.string().required("Card Name is required"),expiry:Yup.string().required("Expiration Date is required").matches(/^(0[1-9]|1[0-2])\/\d{2}$/,"Invalid Expiration Date"),cvc:Yup.string().required("CVV is required").matches(/^\d{3}$/,"CVV must be 3 digits"),country:Yup.string().required("Country is required")});return react_1.default.createElement(material_1.Container,{maxWidth:"sm"},react_1.default.createElement(material_1.Grid,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",style:{minHeight:"100vh"}},react_1.default.createElement(material_1.Box,{component:material_1.Paper,elevation:2,sx:{padding:3,display:"flex",flexDirection:"column",alignItems:"center",backgroundImage:"linear-gradient(to bottom right, #385170,#142d4c,  #38598b)",borderRadius:"10px",backgroundColor:"transparent"}},react_1.default.createElement(material_1.Grid,{item:!0,xs:12},react_1.default.createElement("div",{className:"rccs__card rccs__card--unknown"},react_1.default.createElement(react_credit_cards_2_1.default,{number:u.number,name:u.name,expiry:u.expiry,cvc:u.cvc}))),react_1.default.createElement(formik_1.Formik,{initialValues:u,validationSchema:E,onSubmit:function(){}},function(e){var r=e.isSubmitting;return react_1.default.createElement(formik_1.Form,null,react_1.default.createElement(material_1.Grid,{container:!0,spacing:1},react_1.default.createElement(material_1.Grid,{item:!0,xs:12},react_1.default.createElement(formik_1.Field,{as:material_1.TextField,fullWidth:!0,label:"Card Number",variant:"outlined",name:"number",value:u.number,onChange:l,onFocus:a,InputLabelProps:{style:{color:"primary"}},style:{borderRadius:"35px"}}),react_1.default.createElement(formik_1.ErrorMessage,{name:"number",component:"div",className:"error",style:{fontSize:"small",color:"red"}})),react_1.default.createElement(material_1.Grid,{item:!0,xs:12},react_1.default.createElement(formik_1.Field,{as:material_1.TextField,fullWidth:!0,label:"Card Name",variant:"outlined",name:"name",value:u.name,onChange:function(e){m(__assign(__assign({},u),{name:e.target.value}))},onFocus:a}),react_1.default.createElement(formik_1.ErrorMessage,{name:"name",component:"div",className:"error",style:{fontSize:"small",color:"red"}})),react_1.default.createElement(material_1.Grid,{item:!0,xs:6},react_1.default.createElement(formik_1.Field,{as:material_1.TextField,fullWidth:!0,label:"Expiration Date",variant:"outlined",name:"expiry",value:u.expiry,onChange:c,onFocus:a}),react_1.default.createElement(formik_1.ErrorMessage,{name:"expiry",component:"div",className:"error",style:{fontSize:"small",color:"red"}})),react_1.default.createElement(material_1.Grid,{item:!0,xs:6},react_1.default.createElement(formik_1.Field,{as:material_1.TextField,fullWidth:!0,label:"CVC",variant:"outlined",name:"cvc",value:u.cvc,onChange:function(e){m(__assign(__assign({},u),{cvc:e.target.value}))},onFocus:a}),react_1.default.createElement(formik_1.ErrorMessage,{name:"cvc",component:"div",className:"error",style:{fontSize:"small",color:"red"}})),react_1.default.createElement(material_1.Grid,{item:!0,xs:12},react_1.default.createElement(formik_1.Field,{as:material_1.TextField,fullWidth:!0,label:"Country",variant:"outlined",name:"country",value:u.country,onClick:t,onFocus:a,style:{borderRadius:"35px"}}),react_1.default.createElement(formik_1.ErrorMessage,{name:"country",component:"div",className:"error",style:{fontSize:"small",color:"red"}}),g&&react_1.default.createElement("div",{className:"error",style:{fontSize:"small",color:"red"}},"Credit card submission is blocked for the selected country."),react_1.default.createElement(material_1.Popover,{open:Boolean(b),anchorEl:b,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"left"}},react_1.default.createElement("div",{style:{maxHeight:"200px",overflowY:"scroll",backgroundColor:"#001f3f"}},Data_1.countries.map(function(e,r){return react_1.default.createElement(material_1.MenuItem,{key:r,value:e,onClick:function(){m(__assign(__assign({},u),{country:e})),i()}},e)}))))),react_1.default.createElement(material_1.Grid,{item:!0,xs:12},react_1.default.createElement(material_1.Button,{type:"submit",fullWidth:!0,variant:"outlined",color:"primary",sx:{mt:3,mb:2,borderRadius:"25px"},disabled:r||g,onClick:n},"Submit Card")))}))))};exports.default=CreditCard;
//# sourceMappingURL=CreditCard.min.js.map
